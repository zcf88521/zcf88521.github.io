$(function () {
    var btnLis = $(".tabs li");
    var tabDiv = $(".tab-content div");
    var siftBtn = $(".tabs .sift");
    var seachColse=$(".sift-seach b");
    var seach=$(".sift-seach input")
    //var liArrow=$(".tabs li i");
    btnLis.on("click", function () {
        index = $(this).index();
        if (tabDiv.eq(index).hasClass("show")) {
            if (index == btnLis.length - 1) {
                siftBtn.css({
                    background: 'url("../../images/sift.svg") no-repeat center/25px 25px'
                })
            }
            tabDiv.eq(index).removeClass("show");
        } else {
            if (index == btnLis.length - 1) {
                siftBtn.css({
                    background: 'url("../../images/closexxx.svg") no-repeat center/25px 25px'
                })
            }
            tabDiv.eq(index).addClass("show").siblings().removeClass("show");
        }
    })

    //搜索框清空按钮
    seachColse.on("click",function(){
        seach.val("");
        $(this).fadeOut(200);
    })
    //搜索框的事件
    seach.on("keyup",function(){
        if($(this).val()==""){
            seachColse.fadeOut(200);
        }else{
            seachColse.fadeIn(200);
        }
    })

    /***************************ajax逻辑区************************/
    var tabs_1=$(".tabs_1");
    var tabs1_ul=$(".tabs-1 ul");
    var tabsLis=$(".tabs_1 li")
    var tabs_2=$(".tabs_2");
    var tabs2_ul=$(".tabs-2 ul");
    var tabs_3=$(".tabs_3");
    var goodsId=0;
    var cityid=0;
    var showUl=$(".showUl");
    //btnLis.eq(0).on("click",function(){

    //})
    //btnLis.eq(1).on("click",function(){

    //})

    /************京东***********/
    responesData("http://139.199.157.195:9090/api/getgsshop",function(data){
        var tabs1=template("tabs_1",data);
        tabs1_ul.html("");
        tabs1_ul.append(tabs1);
        var tabs1_lis=$(".tabs-1 ul li");
        tabs1_lis.on("click",function(){
            goodsId=$(this).index();
            $.ajax({
                url:"http://139.199.157.195:9090/api/getgsproduct",
                data:{
                    shopid:goodsId,
                    areaid:cityid
                },
                success:function(siftData){
                    var showGods=template("showGoods",siftData);
                    showUl.html("");
                    showUl.append(showGods);
                }
            })
            //console.log(goodsId);
        })
    })

    /****************地区*****************/
    responesData("http://139.199.157.195:9090/api/getgsshoparea",function(data){
        var tabs2=template("tabs_2",data);
        tabs2_ul.html("");
        tabs2_ul.append(tabs2);
        var tabs2_lis=$(".tabs-2 ul li");
        tabs2_lis.on("click",function(){
            cityid=$(this).index();
            $.ajax({
                url:"http://139.199.157.195:9090/api/getgsproduct",
                data:{
                    shopid:goodsId,
                    areaid:cityid
                },
                success:function(siftData){
                    var showGods2=template("showGoods",siftData);
                    showUl.html("");
                    showUl.append(showGods2);
                }
            })
        })

    })


    /**
     * 1点击商城某一个获取index 区域就默认选择第一个
     * 2渲染页面
     * 1点击区域 先获取点击的商城下标然后在获取点击区域的下标 点击区域的时候需要获取两个值 商城id 区域id
     * 2渲染页面
     */






function responesData(url,callback){
    $.ajax({
        url:url,
        dataType:"json",
        success:function(data){
           callback(data);

        }
    })
}






















    //siftBtn.on("click",function(){
    //
    //})
})


//  index = $(this).index();
//     if(tabDiv.eq(index).hasClass("show")){
//       tabDiv.eq(index).removeClass("show");
//     }else{
//       tabDiv.eq(index).addClass("show").siblings().removeClass("show");
//     }
//   })